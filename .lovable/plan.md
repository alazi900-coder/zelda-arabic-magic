

# ุชุญุณูู ุญูุงูุฉ ุงููุณูู + ุฒุฑ ุฅุตูุงุญ ุงููุณูู ูุน ูุนุงููุฉ

## ุงููุดููุฉ
1. ุญูุงูุฉ ุงููุณูู ูู ุงูุชุฑุฌูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู ุชุญุชุงุฌ ุชุนุฒูุฒ (ุงูุนูุงุตุฑ ุงููุงุฆุจุฉ TAG_N ูุฏ ุชูุญุฐู ุฃู ุชุชุบูุฑ)
2. ูุง ุชูุฌุฏ ูุงุฌูุฉ ูุนุงููุฉ ูุฅุตูุงุญ ุงููุณูู ุงูุชุงููุฉ - ุงูุฅุตูุงุญ ุงูุญุงูู ููุทุจู ูุจุงุดุฑุฉ ุจุฏูู ุฅุธูุงุฑ ุงูููุงุฑูุฉ

## ุงูุญู

### 1. ุชุนุฒูุฒ ุญูุงูุฉ ุงููุณูู ูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู

**ุงูููู: `supabase/functions/translate-entries/index.ts`**
- ุชุญุณูู ุงูุจุฑููุจุช (prompt) ุจุชุนูููุงุช ุฃููู ูุญูุงูุฉ ุงูุนูุงุตุฑ ุงููุงุฆุจุฉ
- ุงุถุงูุฉ ุชุญูู (validation) ุจุนุฏ ุงุณุชูุงู ุงูุชุฑุฌูุฉ: ุงุฐุง ูููุฏ ุฃู TAG_Nุ ููุนุงุฏ ุงุฏุฑุงุฌู ุชููุงุฆูุงู
- ุงุถุงูุฉ ููุท ุฃุฑูุงู ูุซู `[ML:number digit=8 ]` ุงูุฐู ูุญุชูู ูุณุงูุงุช ุฏุงุฎููุฉ

**ุงูููู: `src/lib/xc3-tag-protection.ts`**
- ุงุถุงูุฉ ุญูุงูุฉ ููุฃููุงุท ุงูุฑูููุฉ ูุน ูุณุงูุงุช ูุซู `[ML:number digit=8 ]`
- ุชุญุณูู ููุท ุงูุฃููุงุณ ุงููุฑุจุนุฉ ููุดูู ุงููุณุงูุงุช ุงูุฏุงุฎููุฉ

### 2. ููุญุฉ ุฅุตูุงุญ ุงููุณูู ูุน ูุนุงููุฉ (ุจุฏูู ุฐูุงุก ุงุตุทูุงุนู)

**ููู ุฌุฏูุฏ: `src/components/editor/TagRepairPanel.tsx`**
- ููุญุฉ ุชุนุฑุถ ุฌููุน ุงููุตูุต ุฐุงุช ุงููุณูู ุงูุชุงููุฉ
- ููู ูุต: ุนุฑุถ "ูุจู ุงูุฅุตูุงุญ" ู "ุจุนุฏ ุงูุฅุตูุงุญ" ุฌูุจุงู ุฅูู ุฌูุจ
- ุงุฒุฑุงุฑ ููู ูุต: "ููุงููุฉ" ุฃู "ุฑูุถ"
- ุงุฒุฑุงุฑ ุฏูุนุฉ ูุงุญุฏุฉ: "ูุจูู ุงููู" ู "ุฑูุถ ุงููู"
- ุนุฏุงุฏ ููุถุญ ุนุฏุฏ ุงููุณูู ุงูุชุงููุฉ ูุนุฏุฏ ุงูุชู ุณูุชู ุงุตูุงุญูุง
- ูุณุชุฎุฏู `previewTagRestore` ุงูููุฌูุฏ ูู `xc3-tag-restoration.ts`

**ุงูููู: `src/pages/Editor.tsx`**
- ุงุถุงูุฉ ุญุงูุฉ (state) ููุชุญ/ุงุบูุงู ููุญุฉ ุงูุฅุตูุงุญ
- ุฑุจุท ุฒุฑ "ุฅุตูุงุญ ุงููุณูู ๐ง" ุงูููุฌูุฏ ุจูุชุญ ุงูููุญุฉ ุจุฏูุงู ูู ุงูุชุทุจูู ุงููุจุงุดุฑ

**ุงูููู: `src/hooks/useEditorState.ts`**
- ุชุนุฏูู `handleLocalFixAllDamagedTags` ููุฏุนู ุชุทุจูู ุงูุฅุตูุงุญุงุช ุงููุฎุชุงุฑุฉ ููุท (ูุงุฆูุฉ ููุงุชูุญ ูุญุฏุฏุฉ)

## ุงูุชูุงุตูู ุงูุชูููุฉ

### ููุญุฉ ุฅุตูุงุญ ุงููุณูู (TagRepairPanel)

```text
+------------------------------------------+
| ุฅุตูุงุญ ุงููุณูู ุงูุชุงููุฉ (12 ูุต)            |
| [ูุจูู ุงููู โ] [ุฑูุถ ุงููู โ]             |
+------------------------------------------+
| ุงููุต 1: ActorMsg/Enemy:5                 |
| ูุจู: ูุฑุญุจุง ุนุงูู                          |
| ุจุนุฏ: [E000] ูุฑุญุจุง ุนุงูู [E001]            |
| [ููุงููุฉ โ] [ุฑูุถ โ]                     |
+------------------------------------------+
| ุงููุต 2: ...                              |
+------------------------------------------+
```

### ุชุนุฒูุฒ ุงูุญูุงูุฉ ูู Edge Function

```text
1. ุงุถุงูุฉ ุชุนูููุงุช ุฃุตุฑุญ ูู ุงูุจุฑููุจุช:
   "NEVER remove or modify TAG_N placeholders"

2. ุชุญูู ุจุนุฏ ุงูุชุฑุฌูุฉ (post-validation):
   - ุงุณุชุฎุฑุงุฌ ูู TAG_N ูู ุงููุต ุงูุฃุตูู ุงูููุธู
   - ุงูุชุญูู ูู ูุฌูุฏูุง ูู ุงููุชูุฌุฉ
   - ุงุฐุง ููุฏ ุฃู TAGุ ุงุนุงุฏุฉ ุงุฏุฑุงุฌู ูู ุฃูุฑุจ ูููุน ููุทูู

3. ุชูุณูุน ููุท ุงูุฃููุงุณ ุงููุฑุจุนุฉ:
   ูุจู: /\[\w+:[^\]]*\]/
   ุจุนุฏ: /\[\w+:[^\]]*?\s*\]/  (ูุดูู ุงููุณุงูุงุช ุงูุฒุงุฆุฏุฉ)
```

### ุชุฏูู ุงูุนูู

1. ุงููุณุชุฎุฏู ูุถุบุท ุฒุฑ "ุฅุตูุงุญ ุงููุณูู ๐ง"
2. ุชููุชุญ ููุญุฉ TagRepairPanel
3. ุงูููุญุฉ ุชุณุชุฎุฏู `previewTagRestore` ูุญุณุงุจ ุงูููุงุฑูุงุช
4. ุงููุณุชุฎุฏู ูุฑุงุฌุน ูู ุชุบููุฑ ูููุงูู ุฃู ูุฑูุถ
5. ุนูุฏ ุงูููุงููุฉ ุชูุทุจู ุงูุชุบููุฑุงุช ุงููุฎุชุงุฑุฉ ููุท ูุน ุญูุธ ูุณุฎุฉ ููุชุฑุงุฌุน

