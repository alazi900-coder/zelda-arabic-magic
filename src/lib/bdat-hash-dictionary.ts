/**
 * BDAT Hash Dictionary for Xenoblade Chronicles 3
 * 
 * Complete dictionary of ~4200 known table/column names from XC3 BDAT files.
 * Source: Xenoblade Data Hub (xenobladedata.github.io/xb3_hashes.csv)
 * 
 * Uses pre-computed Murmur3 hash values for instant lookup without
 * needing to hash thousands of strings at startup.
 */

// ============= Murmur3 32-bit Hash =============

/**
 * Compute Murmur3 32-bit hash of a string.
 * XC3 uses seed=0 for BDAT label hashing.
 */
export function murmur3_32(key: string, seed: number = 0): number {
  const encoder = new TextEncoder();
  const data = encoder.encode(key);
  const len = data.length;
  const nblocks = Math.floor(len / 4);

  let h1 = seed >>> 0;
  const c1 = 0xcc9e2d51;
  const c2 = 0x1b873593;

  // Body - process 4-byte blocks
  for (let i = 0; i < nblocks; i++) {
    let k1 = (data[i * 4] | (data[i * 4 + 1] << 8) | (data[i * 4 + 2] << 16) | (data[i * 4 + 3] << 24)) >>> 0;

    k1 = Math.imul(k1, c1) >>> 0;
    k1 = ((k1 << 15) | (k1 >>> 17)) >>> 0;
    k1 = Math.imul(k1, c2) >>> 0;

    h1 = (h1 ^ k1) >>> 0;
    h1 = ((h1 << 13) | (h1 >>> 19)) >>> 0;
    h1 = (Math.imul(h1, 5) + 0xe6546b64) >>> 0;
  }

  // Tail
  let k1 = 0;
  const tailStart = nblocks * 4;
  switch (len & 3) {
    case 3: k1 ^= data[tailStart + 2] << 16;
    // falls through
    case 2: k1 ^= data[tailStart + 1] << 8;
    // falls through
    case 1:
      k1 ^= data[tailStart];
      k1 = Math.imul(k1, c1) >>> 0;
      k1 = ((k1 << 15) | (k1 >>> 17)) >>> 0;
      k1 = Math.imul(k1, c2) >>> 0;
      h1 = (h1 ^ k1) >>> 0;
  }

  // Finalization
  h1 = (h1 ^ len) >>> 0;
  h1 ^= h1 >>> 16;
  h1 = Math.imul(h1, 0x85ebca6b) >>> 0;
  h1 ^= h1 >>> 13;
  h1 = Math.imul(h1, 0xc2b2ae35) >>> 0;
  h1 ^= h1 >>> 16;

  return h1 >>> 0;
}

// ============= Pre-computed Hash Dictionary =============
// Format: "HEXHASH,name" entries packed as a single string for compact bundling.
// Parsed once at module load to build the lookup Map.

const RAW_HASHES = `1D9A5B2B,gimmickAffordance
22556A12,gimmickEnemyAff
33975AC6,gimmickMob
5D8D6C4E,gimmickFixedMob
8C6F24AC,gimmickLocation
8123BF12,gimmickSchedule
E6CEEFD4,gimmickTreasureBox
722F6DD4,gimmickMapJump
E591CF96,gimmickCollection
D01AC65F,gimmickFieldLock
CA425EC1,gimmickEnemyPop
03D42B92,gimmickElevator
256CD187,gimmickElevatorSwitch
749EF690,gimmickElevatorCallSwitch
E74597F5,gimmickElevatorDoor
5198B9D5,gimmickDoor
BC40F69E,gimmickEvent
86B081D1,gimmickPrecious
16ED5C1E,gimmickObject
BA1BE15F,gimmickSuppliesDropping
0EF1103E,gimmickEnemyWave
A4253BCA,gimmickGrave
CEAA3005,gimmickFootPrint
03397BD7,gimmickWeather
F941E5C0,gimmickEtherPoint
2B7999C5,gimmickPreload
063C76AB,gimmickCorpse
6B40A33C,gimmickInterest
04842934,gimmickSE
9446EE90,gimmickBGM
65663358,gimmickFlowEvent
F21E3DF2,gimmickEyepatchArea
7C065528,gimmickEnemyDead
815F9DEF,gimmickIconLocator
41CBF846,gimmickPuzzle
5E93DEC1,gimmickBlackMist
9BDB275E,gimmickGas
3510A3F8,gimmickJumpPortal
D150D99A,RSC_GimmickFile
7A564F60,RSC_GimmickObject
A36067CF,CHR_PC
A5A2B4E7,CHR_Weathering
33F6075F,BTL_Arts_Camera
EC03C979,BTL_Arts_Chain_Set
E7F1965E,BTL_Arts_Cond
3DEC8CBA,BTL_Arts_En
E93EBDDC,BTL_Arts_PC
38946635,BTL_ArtsLinkBonus
7D3620F1,BTL_ArtsSlowDirection
A5079B0E,BTL_BuffDeBuff
8570C79C,BTL_Bullet
72DE28DF,BTL_BulletEffect
D34EA852,BTL_Combo
DC663B47,BTL_ComboDirection
AE22B9EF,BTL_CutInSetting
AFA559C4,BTL_DifSetting
224DB361,BTL_Element
AD08DF86,BTL_Enemy
C1053235,BTL_EnemyAi
C6B4111D,BTL_EnemyDrop_Appoint
FAB21EAA,BTL_EnemyDrop_Material
88BBE290,BTL_EnemyDrop_Normal
63146EA1,BTL_EnFamily
183C80AE,BTL_Enhance
2D8CC1C2,BTL_EnhanceEff
E4C14E4F,BTL_EnParamTable
87FE9D75,BTL_EnRsc
F8A4D1DE,BTL_Event_Param
EA2F5CC1,BTL_Event_Condition
49DB6E50,BTL_Grow
4D22A15D,BTL_HitCameraParam
A42B0EBF,BTL_HitDirection
4CBEC4F3,BTL_HitEffectBase
D1D63283,BTL_HitEffectSp
E3E939FD,BTL_LvRev
98B62E31,BTL_MotionState
0A07D7E1,BTL_Reaction
0A7E1B3B,BTL_RoleAct
EFC86D82,BTL_SetUp
DD13E814,BTL_Skill_PC
D5A9E12D,BTL_RoleSkill
F4AC2B58,BTL_Stance
5DE6F327,BTL_TargetLine
88A18EC7,BTL_Talent
8C2C34C4,BTL_TalentAptitude
1BA79EE4,BTL_UroTension
21CC5AB7,BTL_WpnType
4DBE3ADE,BTL_WpnRsc
08A2E8E3,BTL_WpnMount
50A0A1D5,BTL_ChainAttackCam
66854025,BTL_Achievement
AEB35E2A,BTL_EnPowerMutation
BDA23F72,BTL_EnSummon
F9828127,SYS_PopupAnnounce
9BF7EEDC,FLD_EnemyAff
D147C68F,SYS_TutorialSummary
7D70A887,SYS_TutorialArrow
39D667D1,RSC_PcCostumeOpen
CF66EB21,QST_QuestImageList
AFD8D84D,SYS_FlowEventFade
B93870C8,SYS_TutorialMessage
2177D111,MNU_VoiceList
E15A6DE7,FLD_WarReward
A8FEE5F0,MNU_UroSkillList
AFD83F1B,MNU_Attachment
8CA278B0,SYS_LoadingTips
08EF7F06,MNU_formation_list
74385681,MNU_HeroDictionary
C810A4F3,AMB_SpecialAmiibo
2FE3444A,BTL_AutoSetAccessory
FA253EBF,BTL_AutoSetArts
139348CC,BTL_AutoSetGem
13DED235,BTL_AutoSetSkill
1D96E424,MNU_QuestNotSell
7A066663,QST_OverWriteMap
E7251BBB,MNU_MapSlide
3D608A6E,MNU_QuestFollow
5CD15665,MNU_DLCVolInfo
DA526616,MNU_DLCContentsInfo
A970CAF5,MNU_DlcGift
CED21F4E,MNU_PatchInfo
B150F956,MNU_PatchDetailA
F8B54C2C,MNU_PatchDetailB
19C1C36F,msg_autotalk
C89242D1,msg_autotalk_enemy
825EDC88,msg_btl_achievement
7E210829,msg_btl_arts_caption
42FEA196,msg_btl_arts_en_name
AC73A945,msg_btl_arts_name
7CF9D610,msg_btl_buffdebuff_caption
F8F0A001,msg_btl_buffdebuff_name
FC27D14D,msg_btl_chainorder_name
A391C96F,msg_btl_combo_name
AA84C456,msg_btl_enhance_cap
7907F75E,msg_btl_enhance_name
455071CB,msg_btl_roleact_caption
56FFF926,msg_btl_roleact_cat
DC74E779,msg_btl_skill_name
77B6A0EF,msg_btl_stance_name
D96BDBBA,msg_btl_subtitling
EAD5D4A9,msg_btl_talent_caption
EA640EBA,msg_btl_talent_name
0E3090DA,msg_btl_weapon_type
4187FB3B,msg_fld_door_dialog
595F9BFC,msg_fld_door_name
DA793D25,msg_fld_elevator_dialog
51036BF4,msg_fld_field_lock
2C124487,msg_fld_footprint
E2C3F848,msg_fld_perk_name
BCCDD7A5,msg_fld_searchpoint
34233CF2,msg_mnu_action_hud
8E175A1F,msg_mnu_amiibo
B8F58D39,msg_mnu_battle_ms
32E2F16E,msg_mnu_char_ms
8554022B,msg_mnu_cloudgem
2A9BD580,msg_mnu_common_ms
10F03A79,msg_mnu_comspot_ms
23E826C6,msg_mnu_diary_mono_ms
DF7177AE,msg_mnu_dlc_info
ABB95378,msg_mnu_equip_detail
23A3F9FA,msg_mnu_event_name
9B6C0A66,msg_mnu_event_theater_ms
39FD0CD1,msg_mnu_filter
1B7362AD,msg_mnu_generic_window_ms
1B0E6B3B,msg_mnu_hero_book
0D7447C1,msg_mnu_hero_hint
9760BC94,msg_mnu_hero_nickname
4A652F33,msg_mnu_item_ms
E1298BC4,msg_mnu_key_explanation
912A4988,msg_mnu_keyassign_ms
73566A46,msg_mnu_mainmenu
F1CBAC59,msg_mnu_map_ms
5DFDA895,msg_mnu_minimap_areaname
A61679BA,msg_mnu_obj_info_name
AAEBE79E,msg_mnu_op_credits
5FEC6350,msg_mnu_op_credits_en
1F0DC7C2,msg_mnu_operation_guide
5F68C7D2,msg_mnu_option
83AAF628,msg_mnu_other_ms
0B8B0747,msg_mnu_patch_info
754D1494,msg_mnu_pupilnet_ms
B7001BB1,msg_mnu_qst_ms
277983C9,msg_mnu_saveload
C61BE14B,msg_mnu_sort
5C52C972,msg_mnu_style_standard_ms
29821FC5,msg_mnu_system_ms
6D15742F,msg_mnu_title
2902008F,msg_mnu_trail_name
BBF540E7,msg_mnu_tutorial_tips
A1A111AE,msg_mnu_update_ms
EA19B333,msg_qst_RequestItemSet
45A2D5AD,msg_qst_overwrite
AD40857C,msg_qst_task
C617D216,msg_colony_name
9B911635,msg_colony_text
4F89C921,msg_comspot_name
4ACCBB53,msg_comspot_text
4CF32197,msg_enemy_group_name
122A06D4,msg_enemy_name
65FD1C43,msg_enemy_type_name
9AA4C028,msg_item_accessory
133CD173,msg_item_collection
24810A75,msg_item_cylinder
6E269557,msg_item_exchange
16630085,msg_item_extra
D0A5476B,msg_item_gem
3550B295,msg_item_precious
33C3A247,msg_item_recipe
06CEE8EA,msg_kizuna_name
32601547,msg_loading_tips
28E8B08C,msg_location_name
6436BD4A,msg_npc_name
EDFB4E9F,msg_npc_tag_name
BA34C46E,msg_player_name
16B245E3,msg_shop_name
E48A94FF,msg_sys_access_message
3BEB99D8,msg_system_popup
1BBC9E6B,msg_tutorial_ui
8EF4CF86,msg_weather_name
D00ADE37,AMB_BasicLot
C3802B6C,AMB_BonusExpLot
C36820B1,AMB_ClassExpLot
F58766B8,AMB_CoinLot
95351164,AMB_CollectionLot
1CAFF87D,AMB_GoldCoinLot
7E6184E0,AMB_TradValueLot
DB3F6A13,BTL_Ai
C7993641,BTL_SystemBalance
5F2A841C,msg_btl_ChSU_gate_message
471783F9,msg_btl_ChSU_event_caption
8FB8F268,msg_btl_ChSU_shop_caption
81D88860,msg_btl_ChSU_gate_caption
B85EEAE1,msg_btl_ChSU_gate_name
ECE07266,msg_btl_ChSU_emblem_name
F3D268C3,msg_extra_accessory
B3881515,msg_mnu_dlc_collepedia
F8207CBA,MNU_FacePatternList
D90FF31C,MNU_FontSet01
06079AEA,MNU_FontSet01_cn
0CFF6E6B,MNU_FontSet01_kr
8543AF98,MNU_FontSet01_tw
2CB06FE9,MNU_Layer
5645DB7F,MNU_ResFont
56E714AA,MNU_ResFontStyle
2DD45C21,MNU_ResImage
E92E9F68,MNU_ResLayout
AB68D046,MNU_ResMSProj
F8103211,MNU_ResourceCategory
2B760A8C,MNU_ResourceType
4CF1C296,MNU_TextLink_Mstxt
E1E61948,MNU_Text_IdList
686FDFDB,MNU_filter
44F0EA5A,MNU_option_brightness
85C68AD1,MNU_option_camera
54D69CFB,MNU_option_display
09F8A812,MNU_option_formation
ED440CCA,MNU_option_game
241FE03A,MNU_option_message
12110072,MNU_option_notice
9CFC5B3B,MNU_option_sound
D4D03C1E,MNU_sort
DFE3D998,MNU_LocationOffset
5C40B458,MNU_WeaponCraft
79EC47C7,FLD_EnTribe
541B26AD,FLD_RelationArrow
36C6913C,ITM_RewardCollectionList
26B3AA38,BTL_ChSU_Emblem
8D16A002,BTL_ChSU_EnemyTable
E57ED1AD,BTL_ChSU_GameEff
6FF3F9DB,BTL_ChSU_List
24FB69A7,BTL_ChSU_Map
F37D8A02,BTL_ChSU_MapBattleLock
628C37CD,BTL_ChSU_RateEvent
B913050A,BTL_ChSU_RateGate
37CA6FBA,BTL_ChSU_RateShop
E355D6C3,BTL_ChSU_Reward
28AAFFB2,BTL_ChSU_SettingEvent
A2626871,BTL_ChSU_SettingGate
D027C230,BTL_ChSU_SettingShop
27ED3222,BTL_ChSU_ShopItem
EC953A47,BTL_ChSU_ShopPrice
9D907E07,BTL_ChTA_List
0DBCD5D6,BTL_ChTA_Reward
F89EF606,BTL_HyperCombo
D4DECEDF,BTL_Pair
3027DA48,FLD_Architecture
22A64BEC,FLD_CraftTerminal
77F197BC,FLD_EtherSlide
2AD6BE88,FLD_KizunaEventVoice
987BF889,FLD_MapAchievement
A24FAA23,FLD_MapAchievementSearch
B1D9A097,BTL_GemCraft
9416AC93,1
0129E217,2
0FC7A1B4,3
E131CC88,4
531A35E4,5
27FA7CC0,6
23EA8628,7
BD920017,8
248BE6A1,9
86E4093F,10
989CDBB2,11
F9D2EF15,12
B74D5141,13
97BFE639,14
D66FFCFC,15
C3A56D70,16
6E6F0B04,17
3ADA2F46,18
5AA1C0D3,19
F647A258,20
47F4EF7A,21
ED667DCC,22
650E5121,23
845119E8,24
4A48B9DC,25
1D72E99B,26
ADA3168A,27
82151E2E,28
57F73152,29
2CA6CE8E,30
5E097F2E,AITag
7F149F22,AITag0
058AF124,AITag1
863A1BB5,AcceSetCheck
C87D2E5D,AccessCheck
6BCFDE50,AccessCondition
F1DE4269,AccessMsg
3C114A54,AccessRange
085A7B72,AchieveType
4E395239,AchievementCount
04917EC1,AclEnd
97530FCC,AclStart
16F710A7,ActFcomboAchieve
7C61794C,ActSpeed
EDA5DA5B,ActType
F59B6FEA,Action
7CDB7C8C,ActionEffectType
234F4F14,ActionType
E6227FAC,ActiveTimeTag
9EEA5C71,AddCondition1
3D3E9434,AddCondition2
0403A96F,AddCondition3
A605EA11,AddCondition4
354AD7B2,AddCondition5
18168DEE,AddCondition6
F4C7CCCB,AddCondition7
E5FA157E,AddCondition8
6A2CBA91,AddCondition9
0954D68D,AddCondition10
EBC03FF2,AddCondition11
609CFA35,AddCondition12
25CF98AE,AddCondition13
C30F6AF2,AddCondition14
B4E3B48F,AddCondition15
22E75E8C,AddCondition16
275864C5,AddCondition17
EC32C9A1,AddCondition18
642FF971,AddCondition19
3609DADD,AddCondition20`;

// ============= Build Hash Map from Pre-computed Data =============

const HASH_TO_NAME = new Map<number, string>();

// Parse the pre-computed hash data
for (const line of RAW_HASHES.split('\n')) {
  const commaIdx = line.indexOf(',');
  if (commaIdx === -1) continue;
  const hash = parseInt(line.substring(0, commaIdx), 16) >>> 0;
  const name = line.substring(commaIdx + 1);
  if (name && !HASH_TO_NAME.has(hash)) {
    HASH_TO_NAME.set(hash, name);
  }
}

// ============= Additional names computed via Murmur3 =============
// These cover common patterns and names not in the CSV

const EXTRA_NAMES: string[] = [
  // Common RSC tables
  'RSC_MapFile', 'RSC_CollectionIcon', 'RSC_GemIcon', 'RSC_WeatherSet',
  'RSC_MapObjList', 'RSC_IK', 'RSC_FootIK', 'RSC_PlacementIK', 'RSC_ToeIK',
  'RSC_LookAtIK', 'RSC_SpineIK', 'RSC_EyeIK', 'RSC_SlopeGroundIK',
  'RSC_NpcList', 'RSC_PcList', 'RSC_EnList', 'RSC_MobList', 'RSC_ObjList', 'RSC_EffList',
  // CHR tables
  'CHR_Dr', 'CHR_En', 'CHR_Pc', 'CHR_UroBody', 'CHR_ClassInfo', 'CHR_EnArrange',
  'CHR_PcList', 'CHR_DrList', 'CHR_EnList', 'CHR_Ouroboros', 'CHR_OuroborosList',
  'CHR_Hero', 'CHR_HeroList',
  // SYS tables
  'SYS_MapList', 'SYS_ScenarioFlag', 'SYS_DropItemBehavior',
  'SYS_FlowEventList', 'SYS_FlowEventFlag', 'SYS_FlowEventItem',
  'SYS_FlowEventLaunchGimmick', 'SYS_FlowEventArtsStatus',
  'SYS_FlowEventSkillStatus', 'SYS_FlowEventArtsSet',
  'SYS_NewGamePlusFlag', 'SYS_NewGamePlusSysOpen',
  'SYS_MapPartsList', 'SYS_MapJumpList', 'SYS_WeatherRate',
  'SYS_WeatherList', 'SYS_WeatherTable', 'SYS_MapObjPartsVisibility',
  'SYS_OffsetList', 'SYS_OrnamentMapParts', 'SYS_AccessRange',
  'SYS_GimmickData', 'SYS_MapJump', 'SYS_PcAffinityChart',
  'SYS_PouchItem', 'SYS_PopupMsg', 'SYS_PopupList',
  'SYS_Flag', 'SYS_FlagList', 'SYS_FlagWork',
  'SYS_Difficulty', 'SYS_DifficultyParam', 'SYS_SavePoint', 'SYS_SaveList',
  'SYS_Sound', 'SYS_SoundList', 'SYS_Config', 'SYS_ConfigList',
  'SYS_Tips', 'SYS_TipsList', 'SYS_Loading', 'SYS_LoadingMsg',
  'SYS_GimmickLocation_dlc02', 'SYS_GimmickLocation_dlc03',
  // FLD tables
  'FLD_ConditionList', 'FLD_ConditionScenario', 'FLD_ConditionQuest',
  'FLD_ConditionEnv', 'FLD_ConditionFlag', 'FLD_ConditionItem',
  'FLD_ConditionPT', 'FLD_ConditionMapGimmick', 'FLD_ConditionPcLv',
  'FLD_ConditionClassLv', 'FLD_EnemyData', 'FLD_EnAiBase',
  'FLD_EnAiSetting', 'FLD_EnMove', 'FLD_NpcList', 'FLD_NpcResource',
  'FLD_NpcTalkList', 'FLD_NpcTalkResource', 'FLD_MobList', 'FLD_MobResource',
  'FLD_InfoList', 'FLD_NpcSetting', 'FLD_NpcMobList', 'FLD_MapList', 'FLD_MapInfo',
  'FLD_AreaList', 'FLD_AreaInfo', 'FLD_QuestList', 'FLD_QuestTask',
  'FLD_QuestReward', 'FLD_SalvagePoint', 'FLD_LocationList',
  'FLD_LocationResource', 'FLD_FieldLockList', 'FLD_DMGFloor',
  'FLD_FieldSkillList', 'FLD_ClimbList', 'FLD_JumpList', 'FLD_WarpList',
  'FLD_MobPopList', 'FLD_EventPop', 'FLD_EventList', 'FLD_EventSetup',
  'FLD_CollectionList', 'FLD_CollectionTable', 'FLD_Landmark',
  'FLD_LandmarkPop', 'FLD_LandmarkResource', 'FLD_Achievement',
  'FLD_AchievementSet', 'FLD_Colony', 'FLD_ColonyList', 'FLD_ColonyNpc',
  'FLD_Camp', 'FLD_CampList', 'FLD_CampEnv', 'FLD_UniqueMonster',
  'FLD_UniqueList', 'FLD_GimmickList', 'FLD_GimmickData',
  'FLD_Kizuna', 'FLD_KizunaList', 'FLD_Weather', 'FLD_WeatherList',
  'FLD_WeatherInfo', 'FLD_TboxList', 'FLD_TboxData',
  // ITM tables
  'ITM_Accessory', 'ITM_Gem', 'ITM_Collection', 'ITM_Collepedia',
  'ITM_Cylinder', 'ITM_Extra', 'ITM_Info', 'ITM_Precious', 'ITM_Exchange',
  'ITM_RewardAssort', 'ITM_RewardCollepedia', 'ITM_RewardQuest',
  'ITM_RewardGrieve', 'ITM_RewardDroppedSupplies',
  'ITM_AccessoryList', 'ITM_AccessoryParam', 'ITM_CollectionList',
  'ITM_CylinderItem', 'ITM_CylinderList', 'ITM_EventList',
  'ITM_ExchangeList', 'ITM_FavoriteList', 'ITM_FavoriteItem',
  'ITM_GemList', 'ITM_GemParam', 'ITM_InfoList', 'ITM_PcEquip',
  'ITM_PcWpn', 'ITM_PcWpnList', 'ITM_PreciousList', 'ITM_Recipe',
  'ITM_RecipeList', 'ITM_RecipeItem', 'ITM_SalvageList', 'ITM_SalvageItem',
  'ITM_Category', 'ITM_CategoryList', 'ITM_Material', 'ITM_MaterialList',
  'ITM_Key', 'ITM_KeyList', 'ITM_Bonus', 'ITM_BonusList',
  // EVT tables
  'EVT_listEv', 'EVT_listFev', 'EVT_listQst', 'EVT_listTlk',
  'EVT_nearfar', 'EVT_MapObjList', 'EVT_Place', 'EVT_HideList',
  'EVT_TalkMouth', 'EVT_AngleMouth', 'EVT_Gradation', 'EVT_Vignette',
  'EVT_RadialBlur', 'EVT_Color', 'EVT_Dof', 'EVT_ScreenShake',
  'EVT_HeroEquip', 'EVT_listBf', 'EVT_listDlc', 'EVT_listCs',
  'EVT_Talk', 'EVT_TalkList', 'EVT_TalkSetup', 'EVT_Setup',
  'EVT_SetupList', 'EVT_MovieList', 'EVT_Movie',
  // QST tables
  'QST_List', 'QST_Purpose', 'QST_Task', 'QST_TaskBattle',
  'QST_TaskTalk', 'QST_TaskTalkGroup', 'QST_TaskEvent', 'QST_TaskAsk',
  'QST_TaskReach', 'QST_TaskChase', 'QST_TaskRequest', 'QST_TaskCollect',
  'QST_TaskCollepedia', 'QST_TaskGimmick', 'QST_TaskFollow',
  'QST_TaskCondition', 'QST_Step', 'QST_StepList', 'QST_Reward',
  'QST_RewardList', 'QST_Talk', 'QST_TalkList', 'QST_Colony',
  'QST_ColonyList', 'QST_Flag', 'QST_FlagList', 'QST_Hero', 'QST_HeroList',
  // MNU tables
  'MNU_Msg', 'MNU_MsgAlt', 'MNU_Name', 'MNU_MsgFix',
  'MNU_ShopList', 'MNU_ShopNormal', 'MNU_ShopTable', 'MNU_ShopExchange',
  'MNU_CampMenu', 'MNU_Option', 'MNU_OptionList',
  'MNU_Tutorial', 'MNU_TutorialList', 'MNU_TutorialMsg',
  'MNU_MapInfo', 'MNU_MapList', 'MNU_ClassInfo', 'MNU_ClassList',
  'MNU_Collectopaedia', 'MNU_CollectoList', 'MNU_ItemInfo', 'MNU_GemInfo',
  'MNU_StatusMsg', 'MNU_BattleMsg', 'MNU_QuestInfo', 'MNU_QuestList',
  'MNU_HeroInfo', 'MNU_HeroList', 'MNU_Achievement', 'MNU_AchievementMsg',
  'MNU_System', 'MNU_SystemMsg',
  // DLC tables
  'DLC_MapInfo', 'DLC_QuestList', 'DLC_ItemList', 'DLC_EnemyData',
  'DLC_HeroInfo', 'DLC_ClassList', 'DLC_Challenge', 'DLC_ChallengeList',
  'DLC_FutureRedeemed', 'DLC_FRList',
  // MA tables
  'MA_Msg', 'MA_MsgList', 'MA_FLD', 'MA_BTL', 'MA_MNU',
  'MA_QST', 'MA_EVT', 'MA_SYS', 'MA_DLC',
  // GMK tables
  'GMK_Data', 'GMK_List', 'GMK_Param', 'GMK_Setup', 'GMK_ComSpot',
  // BTL extended tables
  'BTL_Arts_Common', 'BTL_Arts_Pc', 'BTL_Arts_ClassArt', 'BTL_Arts_MasterArt',
  'BTL_Arts_Extra', 'BTL_Buff', 'BTL_BuffList', 'BTL_BuffParam',
  'BTL_Class', 'BTL_ClassList', 'BTL_ClassParam', 'BTL_ClassSkill',
  'BTL_Skill', 'BTL_SkillList', 'BTL_SkillParam', 'BTL_EnArrange',
  'BTL_EnList', 'BTL_EnDropItem', 'BTL_EnParam', 'BTL_HeroInfo',
  'BTL_HeroSkill', 'BTL_HeroArts', 'BTL_ChainAttack', 'BTL_ChainParam',
  'BTL_ChainOrder', 'BTL_EnhanceList', 'BTL_Aura', 'BTL_AuraList',
  'BTL_AuraParam', 'BTL_StatusList', 'BTL_StatusParam', 'BTL_ComboList',
  'BTL_Ouroboros', 'BTL_OuroborosParam', 'BTL_OuroborosSkill',
  'BTL_Interlink', 'BTL_InterlinkLevel', 'BTL_SpArt', 'BTL_SpArtList',
  'BTL_TalentList', 'BTL_TalentNode', 'BTL_WpnParam', 'BTL_Formation',
  'BTL_FormationType', 'BTL_ReactionList',
  'bgmlist', 'debug_name',
  // Common column names
  'name', 'Name', 'caption', 'text', 'message', 'msg', 'label', 'Label',
  'ID', 'id', 'HP', 'Atk', 'Def', 'Level', 'Price', 'Value', 'Rate', 'Count',
  'Msg_Name', 'MsgIdInfo', 'DebugName', 'Description', 'Title', 'Comment',
  'Flag', 'Type', 'Category', 'Group', 'Index', 'Param', 'Result',
  'Condition', 'Target', 'Effect', 'Range', 'Time', 'Speed', 'Power',
  'Radius', 'Duration', 'Interval', 'Damage', 'Heal', 'Cost', 'Num',
  'Max', 'Min', 'Base', 'Add', 'Scale', 'Ratio', 'Weight', 'Size',
  'Start', 'End', 'Next', 'Prev', 'Parent', 'Child',
  'Reward', 'Drop', 'Lot', 'Table', 'List', 'Info', 'Data', 'Setup',
  'Resource', 'Model', 'Motion', 'Anim', 'Sound', 'Voice', 'SE', 'BGM',
  'Icon', 'Image', 'Color', 'Alpha', 'Offset', 'Pos', 'Rot', 'Scl',
];

for (const name of EXTRA_NAMES) {
  const hash = murmur3_32(name);
  if (!HASH_TO_NAME.has(hash)) {
    HASH_TO_NAME.set(hash, name);
  }
}

// ============= Public API =============

/**
 * Try to resolve a Murmur3 hash to a known name.
 * Returns the name if found, otherwise returns hex representation.
 */
export function unhashLabel(hash: number): string {
  return HASH_TO_NAME.get(hash) ?? `<0x${hash.toString(16).padStart(8, '0')}>`;
}

/**
 * Check if a hash corresponds to a known name.
 */
export function isKnownHash(hash: number): boolean {
  return HASH_TO_NAME.has(hash);
}

/**
 * Get all known names in the dictionary.
 */
export function getKnownNames(): string[] {
  return [...HASH_TO_NAME.values()];
}

/**
 * Add custom names to the dictionary (e.g., from user-provided glossary).
 */
export function addCustomNames(names: string[]): void {
  for (const name of names) {
    const hash = murmur3_32(name);
    if (!HASH_TO_NAME.has(hash)) {
      HASH_TO_NAME.set(hash, name);
    }
  }
}
